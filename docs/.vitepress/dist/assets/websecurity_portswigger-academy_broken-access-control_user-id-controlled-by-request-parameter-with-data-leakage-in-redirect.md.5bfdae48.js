import{_ as e,c as t,o as r,N as a}from"./chunks/framework.0799945b.js";const g=JSON.parse('{"title":"User ID Controlled by Request Parameter with Data Leakage in Redirect","description":"","frontmatter":{},"headers":[],"relativePath":"websecurity/portswigger-academy/broken-access-control/user-id-controlled-by-request-parameter-with-data-leakage-in-redirect.md"}'),o={name:"websecurity/portswigger-academy/broken-access-control/user-id-controlled-by-request-parameter-with-data-leakage-in-redirect.md"},s=a('<h1 id="user-id-controlled-by-request-parameter-with-data-leakage-in-redirect" tabindex="-1">User ID Controlled by Request Parameter with Data Leakage in Redirect <a class="header-anchor" href="#user-id-controlled-by-request-parameter-with-data-leakage-in-redirect" aria-label="Permalink to &quot;User ID Controlled by Request Parameter with Data Leakage in Redirect&quot;">â€‹</a></h1><p>Link: <a href="https://portswigger.net/web-security/access-control/lab-user-id-controlled-by-request-parameter-with-data-leakage-in-redirect" target="_blank" rel="noreferrer">https://portswigger.net/web-security/access-control/lab-user-id-controlled-by-request-parameter-with-data-leakage-in-redirect</a></p><p><img src="https://www.dropbox.com/scl/fi/wvrk1bpunjupmn4g2yr0e/pb-AZ5yQQyIsZ.png?rlkey=9br6a8v7dppwy65caq4n8j3ew&amp;raw=1" alt="description"></p><p>Our task is to obtain the API key of the user carlos. After clicking &quot;Access the lab&quot;, we proceed to &quot;My account&quot;, log in with the provided username and password, which are <em><strong>wiener:peter</strong></em>:</p><p><img src="https://www.dropbox.com/scl/fi/zmrdpi1azrs3cpltm6fnl/pb-u9RB9PYHxR.png?rlkey=ec9idc1b0j4q2fpu27gv0c4xw&amp;raw=1" alt="login wiener peter"></p><p>After logging in, we can observe a few interesting things.</p><ol><li>The API key is visible to the logged-in user.</li><li>The ID parameter equals the username and is visible in the URL bar.</li></ol><p><img src="https://www.dropbox.com/scl/fi/syg8lcwrtcmz6d1dthti8/pb-klMD0Z5yNs.png?rlkey=h9j9m5hivikyvw6htnfrbvoam&amp;raw=1" alt="after logging"></p><p>Let&#39;s see what happens if we replace the user wiener with carlos and press &quot;Enter&quot;:</p><p><img src="https://www.dropbox.com/scl/fi/xy6w7rfk2h92wsby69el0/pb-nCe8zPa8F6.png?rlkey=vuad58c1lu5b9b1g28mos6n67&amp;raw=1" alt="change of the username"></p><p>We are logged out of the application, but Burp Suite is running &quot;underneath&quot;.</p><p>With Burp Suite running in the background, we can check the communication:</p><p><img src="https://www.dropbox.com/scl/fi/982djtnsabc0c93ql5kuy/pb-QRaKEtgAFA.png?rlkey=4jk764lkjre7qdsmy0jvsnclp&amp;raw=1" alt="wrong user redirection"></p><p>In the request with the &quot;carlos&quot; parameter, we see a &quot;302&quot; status, meaning a redirect. Indeed, we saw the login screen in the application, but before that happened - a page with the user&#39;s data was displayed. The correct behavior would be to remove the HTML code from the response and leave only the headers. In this case, we can browse the page content to see if we can find the API key we are interested in:</p><p><img src="https://www.dropbox.com/scl/fi/d4m8b2wgx1e59s0kcsjxp/pb-OtQgVybd8h.png?rlkey=sumpb4p3gzpe3ibp83oan6t8f&amp;raw=1" alt="carlos api key"></p><p>We copy the API key, go to the page, click &quot;Submit solution&quot;. Done:</p><p><img src="https://www.dropbox.com/scl/fi/ny7e1ozqzq2eb520afn4i/pb-zdYLFRWzAz.png?rlkey=yot21gydj57mquptd1i8igdzn&amp;raw=1" alt="submit solution"></p><p><img src="https://www.dropbox.com/scl/fi/m9kcvdhlkgjp966a7sost/pb-tWHBKur2Yp.png?rlkey=5qissdepkptuokas4a76ckilo&amp;raw=1" alt="lab solved"></p>',18),i=[s];function n(p,c,l,d,h,u){return r(),t("div",null,i)}const m=e(o,[["render",n]]);export{g as __pageData,m as default};
