import{_ as e,c as t,o as a,N as s}from"./chunks/framework.0799945b.js";const m=JSON.parse('{"title":"User ID Controlled by Request Parameter","description":"","frontmatter":{},"headers":[],"relativePath":"websecurity/portswigger-academy/authentication/user-id-controlled-by-request-parameter.md"}'),r={name:"websecurity/portswigger-academy/authentication/user-id-controlled-by-request-parameter.md"},o=s(`<h1 id="user-id-controlled-by-request-parameter" tabindex="-1">User ID Controlled by Request Parameter <a class="header-anchor" href="#user-id-controlled-by-request-parameter" aria-label="Permalink to &quot;User ID Controlled by Request Parameter&quot;">â€‹</a></h1><p>Link: <a href="https://portswigger.net/web-security/access-control/lab-user-id-controlled-by-request-parameter" target="_blank" rel="noreferrer">https://portswigger.net/web-security/access-control/lab-user-id-controlled-by-request-parameter</a></p><p><img src="https://www.dropbox.com/scl/fi/0hdgp80nbey7k832dfh2d/pb-FYrk03hdlL.png?rlkey=wf4qdeda7xcnfdj0jmb85oj68&amp;raw=1" alt="user id controlled by request parameter description"></p><p>As described, we will have an example of horizontal privilege escalation here, which is the transition between users at the same level - in this case, between wiener and carlos.</p><p>After going to the &quot;My Account&quot; tab, we log in (we have Burp Suite running in the background). Once logged in, we see that the API key is available:</p><p><img src="https://www.dropbox.com/scl/fi/vukarfosegu58v52wp2fl/pb-FqFEB8R7KK.png?rlkey=vbzju8pyfqheutt86cu6betxr&amp;raw=1" alt="my account wiener"></p><p>It&#39;s worth not only tracking what is displayed in Burp, but also what is displayed in the address bar. In our case, this is visible:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">https://0a6f00a304aa21f280ec94b70053003d.web-security-academy.net/my-account?id=wiener</span></span></code></pre></div><p>We see that an ID is passed, which is the &quot;username&quot; we used.</p><p>Of course, this is also visible in Burp Suite itself:</p><p><img src="https://www.dropbox.com/scl/fi/pea1h9jsy7y6nukropops/pb-QOxb2bRA83.png?rlkey=owcnsabfefkq8o4t8rqzmncyr&amp;raw=1" alt="burp get id wiener"></p><p>We want to switch to carlos&#39;s account, so it&#39;s worth checking what will happen if instead of &quot;wiener&quot;, we enter &quot;carlos&quot;. Right-click and send the request to the Repeater:</p><p><img src="https://www.dropbox.com/scl/fi/ha2z829la1b6wyw8vnmw5/pb-JTXsKVQSlj.png?rlkey=391d10arpdn14x98gx6om0ao4&amp;raw=1" alt="send wiener to repeater"></p><p>In the Repeater, we change &quot;wiener&quot; to &quot;carlos&quot;:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">GET /my-account?id=carlos HTTP/2</span></span></code></pre></div><p>We receive a 200 status in response, which means the response is correct. We check what else we can find and it turns out there&#39;s quite a lot:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">Your username is: carlos&lt;/p&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">&lt;div&gt;Your API Key is: CCzo99zTYW2p6JepKYSFEX0IMOfDegrx&lt;/div&gt;</span></span></code></pre></div><p>We copy the API Key, on the PortSwigger page we click &quot;Submit solution&quot;, paste it, send, and done:</p><p><img src="https://www.dropbox.com/scl/fi/r65ykkvmjtozv67otg02t/pb-rm61A8pZsv.png?rlkey=l35tu8u7ylpgy1y7q89s8343d&amp;raw=1" alt="user id controlled by request parameter solved lab"></p>`,19),n=[o];function i(p,l,c,d,u,h){return a(),t("div",null,n)}const b=e(r,[["render",i]]);export{m as __pageData,b as default};
