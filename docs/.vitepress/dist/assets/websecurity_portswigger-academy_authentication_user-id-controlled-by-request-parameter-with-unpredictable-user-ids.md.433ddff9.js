import{_ as e,c as t,o as s,N as r}from"./chunks/framework.0799945b.js";const w=JSON.parse('{"title":"User ID controlled by request parameter, with unpredictable user IDs","description":"","frontmatter":{},"headers":[],"relativePath":"websecurity/portswigger-academy/authentication/user-id-controlled-by-request-parameter-with-unpredictable-user-ids.md"}'),a={name:"websecurity/portswigger-academy/authentication/user-id-controlled-by-request-parameter-with-unpredictable-user-ids.md"},o=r('<h1 id="user-id-controlled-by-request-parameter-with-unpredictable-user-ids" tabindex="-1">User ID controlled by request parameter, with unpredictable user IDs <a class="header-anchor" href="#user-id-controlled-by-request-parameter-with-unpredictable-user-ids" aria-label="Permalink to &quot;User ID controlled by request parameter, with unpredictable user IDs&quot;">â€‹</a></h1><p>Link: <a href="https://portswigger.net/web-security/access-control/lab-user-id-controlled-by-request-parameter-with-unpredictable-user-ids" target="_blank" rel="noreferrer">https://portswigger.net/web-security/access-control/lab-user-id-controlled-by-request-parameter-with-unpredictable-user-ids</a></p><p><img src="https://www.dropbox.com/scl/fi/vfc35k8zfxftwvvdgywci/pb-CFOJElshCD.png?rlkey=r0f84ipnxs21nw5maoriiqvhw&amp;raw=1" alt="user id controlled by request parameter with unpredictable user ids description"></p><p>This is another example of &quot;<em><strong>horizontal privilege escalation</strong></em>&quot;, this time using a GUID, which stands for Globally Unique Identifier.</p><p>After clicking &quot;<strong>Access the lab</strong>&quot;, we see a blog. It&#39;s noticeable that various identifiers appear in the URL bar when viewing profiles of different users. I&#39;m about to provide screenshots to clarify what I mean.</p><p>I click on the &quot;<strong>View post</strong>&quot; button under the first post:</p><p><img src="https://www.dropbox.com/scl/fi/iu46dfk55muvwyd14y7yc/pb-SVvCOLE0iB.png?rlkey=do1o444ica7dynhe4uhdpllw7&amp;raw=1" alt="view post first post"></p><p>Then on the username:</p><p><img src="https://www.dropbox.com/scl/fi/ojhvk1ox2wp5iwceeyqlq/pb-RhcWVo84UT.png?rlkey=p55gmtsapkhn6p1l03o7hfvia&amp;raw=1" alt="admin screenshot"></p><p>Now you can see the user&#39;s identifier in the URL bar:</p><p>Link: <a href="https://0ab8000f0424435382b0ba4600890061.web-security-academy.net/blogs?userId=90b0df73-318f-4308-9810-753cb157aec1" target="_blank" rel="noreferrer">https://0ab8000f0424435382b0ba4600890061.web-security-academy.net/blogs?userId=90b0df73-318f-4308-9810-753cb157aec1</a></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">userId=the_rest_is_guid</span></span></code></pre></div><p>Since we can obtain the administrator&#39;s GUID, we should also be able to get the user identifier for carlos. After a few seconds of searching, I found post ID 6, which belongs to carlos:</p><p><img src="https://www.dropbox.com/scl/fi/2i5zzsj0cl44bgebiqtov/pb-TIgSNupn4h.png?rlkey=ks7mayagfjypsr7nmrngmh92p&amp;raw=1" alt="carlos post"></p><p>Clicking on his name, we obtain the GUID in the address bar:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">userId=640f2c14-8f0e-44f3-aa69-df3376e7c5eb</span></span></code></pre></div><p>Our task is to obtain the API Key of the user carlos. However, we only have access to the user wiener.</p><p>We log in with the credentials provided in the task:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">wiener:peter</span></span></code></pre></div><p><img src="https://www.dropbox.com/scl/fi/2z3jx3wyd0iu634wnfzex/pb-guTJ9Ex4io.png?rlkey=syfyrl22obffetgbtw3s3jdg7&amp;raw=1" alt="wiener account"></p><p>We check the requests in Burp.</p><p>Let&#39;s see if changing the ID in the request will give us access to carlos&#39;s account:</p><p><img src="https://www.dropbox.com/scl/fi/ddfw2xag0mfw4xw2aminc/pb-dNeQXu7IfA.png?rlkey=6ovb92fzrn60b7quq02dmnpmy&amp;raw=1" alt="get request wiener"></p><p>Right-click on the highlighted request and select &quot;<em><strong>Send to Repeater</strong></em>&quot;.</p><p>We replace userId with carlos&#39;s ID. We send the request. In response, we get status 200:</p><p><img src="https://www.dropbox.com/scl/fi/gh4gb6mjdwwrrefgylium/pb-Iio5TQ6li9.png?rlkey=5kapj8fl0gvduujyz0h4m36es&amp;raw=1" alt="carlos api key"></p><p>We copy the API Key, click &quot;Submit solution&quot; and send the response. Done:</p><p><img src="https://www.dropbox.com/scl/fi/qfy51txr3cx8qogqn4gv1/pb-5jnlH1q3hb.png?rlkey=adprw73574yfezbujlo6zrqmm&amp;raw=1" alt="user id controlled by request parameter with unpredictable user ids lab solved"></p>',28),i=[o];function p(n,c,l,d,u,h){return s(),t("div",null,i)}const g=e(a,[["render",p]]);export{w as __pageData,g as default};
