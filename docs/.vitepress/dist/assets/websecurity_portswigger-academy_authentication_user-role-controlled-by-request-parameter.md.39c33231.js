import{_ as e,c as s,o as a,N as t}from"./chunks/framework.0799945b.js";const g=JSON.parse('{"title":"User Role Controlled by Request Parameter","description":"","frontmatter":{},"headers":[],"relativePath":"websecurity/portswigger-academy/authentication/user-role-controlled-by-request-parameter.md"}'),n={name:"websecurity/portswigger-academy/authentication/user-role-controlled-by-request-parameter.md"},o=t(`<h1 id="user-role-controlled-by-request-parameter" tabindex="-1">User Role Controlled by Request Parameter <a class="header-anchor" href="#user-role-controlled-by-request-parameter" aria-label="Permalink to &quot;User Role Controlled by Request Parameter&quot;">â€‹</a></h1><p>Link: <a href="https://portswigger.net/web-security/access-control/lab-user-role-controlled-by-request-parameter" target="_blank" rel="noreferrer">https://portswigger.net/web-security/access-control/lab-user-role-controlled-by-request-parameter</a></p><p><img src="https://www.dropbox.com/scl/fi/n7b4ai32pexkdx036xkho/pb-FMltvhLooJ.png?rlkey=mh8s4ok2vy3by3kxcuh4g7arh&amp;raw=1" alt="User role controlled by request parameter"></p><p>Upon accessing the &quot;lab,&quot; we see an online store. From the description above, it&#39;s clear that there is a path &quot;<em><strong>/admin</strong></em>&quot;. Let&#39;s append it to the URL:</p><p><a href="https://0ac20088032ca4178199d989007300f7.web-security-academy.net/admin" target="_blank" rel="noreferrer">https://0ac20088032ca4178199d989007300f7.web-security-academy.net/admin</a></p><p>We receive information that the admin panel is only available if we log in as such a user. Sounds logical:</p><p><img src="https://www.dropbox.com/scl/fi/350ult2holkj2egjh2ozi/pb-i4X39EnFCN.png?rlkey=ghnyx5gdqq6i6z446pxzl6esk&amp;raw=1" alt="admin interface only available if logged in as an administrator"></p><p>What&#39;s worth doing before this test is to go to the Proxy &gt; Proxy settings tab:</p><p><img src="https://www.dropbox.com/scl/fi/7a3mgnigpp24quumwalss/pb-likLLahcKQ.png?rlkey=d4l2v2y0e7p0nwrhrgmkle7dp&amp;raw=1" alt="proxy settings"></p><p>Then select the &quot;Intercept requests based on the following rules&quot; option and uncheck whatever is selected in the &quot;Enabled&quot; column:</p><p><img src="https://www.dropbox.com/scl/fi/1q0fviwx7xkssfvd8e50u/pb-TZOgiVjZI5.png?rlkey=n26ck16mwevwr9m2trxzeijj9&amp;raw=1" alt="request interception rules"></p><p>&quot;To configure network traffic interception in Burp Suite, go to the &quot;Proxy&quot; tab, then &quot;Proxy settings&quot;. In the &quot;Request Interception Rules&quot; section, uncheck all options in the &#39;Enabled&#39; column. Then select the &quot;Intercept requests based on the following rules&quot; option. This will pause the interception process in the &quot;Intercept&quot; tab when you capture requests and responses, allowing for manual analysis and management of each received response.&quot;</p><p>In the &quot;Proxy&quot; &gt; &quot;Intercept&quot; tab, click &quot;Open browser&quot;. Navigate to the lab. Click on &quot;My Account&quot;.</p><p><img src="https://www.dropbox.com/scl/fi/4k86sitsx0y5pz65m7pbk/pb-xQqRkzk7z2.png?rlkey=t68eiqo7hlt2wkm59drzuuzv5&amp;raw=1" alt="login panel"></p><p>Make sure that the &quot;Intercept is on&quot; option is enabled. <img src="https://www.dropbox.com/scl/fi/pyd1r99surbm05etz9p7a/pb-cFMtqBCLcD.png?rlkey=57ipdmfmyt0uabpxkwyonwq27&amp;raw=1" alt="intercept is on"></p><p>Log in with the given credentials (wiener:peter) to trace the traffic:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">POST /login HTTP/2</span></span>
<span class="line"><span style="color:#A6ACCD;">Host: 0a0a00e3041ea9d386f88a1b002c00c6.web-security-academy.net</span></span>
<span class="line"><span style="color:#A6ACCD;">Cookie: session=tWXWUqhxxGqK63djWvGAikc3c8cvOnm5</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Length: 68</span></span>
<span class="line"><span style="color:#A6ACCD;">Cache-Control: max-age=0</span></span>
<span class="line"><span style="color:#A6ACCD;">Sec-Ch-Ua: &quot;Not_A Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;120&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Sec-Ch-Ua-Mobile: ?0</span></span>
<span class="line"><span style="color:#A6ACCD;">Sec-Ch-Ua-Platform: &quot;macOS&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Upgrade-Insecure-Requests: 1</span></span>
<span class="line"><span style="color:#A6ACCD;">Origin: https://0a0a00e3041ea9d386f88a1b002c00c6.web-security-academy.net</span></span>
<span class="line"><span style="color:#A6ACCD;">Content-Type: application/x-www-form-urlencoded</span></span>
<span class="line"><span style="color:#A6ACCD;">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.71 Safari/537.36</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span></span>
<span class="line"><span style="color:#A6ACCD;">Sec-Fetch-Site: same-origin</span></span>
<span class="line"><span style="color:#A6ACCD;">Sec-Fetch-Mode: navigate</span></span>
<span class="line"><span style="color:#A6ACCD;">Sec-Fetch-User: ?1</span></span>
<span class="line"><span style="color:#A6ACCD;">Sec-Fetch-Dest: document</span></span>
<span class="line"><span style="color:#A6ACCD;">Referer: https://0a0a00e3041ea9d386f88a1b002c00c6.web-security-academy.net/login</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept-Encoding: gzip, deflate, br</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept-Language: en-GB,en-US;q=0.9,en;q=0.8</span></span>
<span class="line"><span style="color:#A6ACCD;">Priority: u=0, i</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">csrf=kv22Q9hDGCvkx1Uhfd2X2T5xf4mF5tTL&amp;username=wiener&amp;password=peter</span></span></code></pre></div><p>Click &quot;Forward&quot; to check the next response: <img src="https://www.dropbox.com/scl/fi/1wq704xtz39emcvz6lhvt/pb-3yFiKOhGGk.png?rlkey=xqxkr3yftdehlweu1ljfsu0pt&amp;raw=1" alt="forward button"></p><p>It looks like this:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">GET /my-account?id=wiener HTTP/2</span></span>
<span class="line"><span style="color:#A6ACCD;">Host: 0a0a00e3041ea9d386f88a1b002c00c6.web-security-academy.net</span></span>
<span class="line"><span style="color:#A6ACCD;">Cookie: Admin=false; session=MWj6LXlEd6CBFs2e2B4sQy1t9v9K008o</span></span>
<span class="line"><span style="color:#A6ACCD;">Cache-Control: max-age=0</span></span>
<span class="line"><span style="color:#A6ACCD;">Upgrade-Insecure-Requests: 1</span></span>
<span class="line"><span style="color:#A6ACCD;">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.71 Safari/537.36</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span></span>
<span class="line"><span style="color:#A6ACCD;">Sec-Fetch-Site: same-origin</span></span>
<span class="line"><span style="color:#A6ACCD;">Sec-Fetch-Mode: navigate</span></span>
<span class="line"><span style="color:#A6ACCD;">Sec-Fetch-User: ?1</span></span>
<span class="line"><span style="color:#A6ACCD;">Sec-Fetch-Dest: document</span></span>
<span class="line"><span style="color:#A6ACCD;">Sec-Ch-Ua: &quot;Not_A Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;120&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Sec-Ch-Ua-Mobile: ?0</span></span>
<span class="line"><span style="color:#A6ACCD;">Sec-Ch-Ua-Platform: &quot;macOS&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">Referer: https://0a0a00e3041ea9d386f88a1b002c00c6.web-security-academy.net/login</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept-Encoding: gzip, deflate, br</span></span>
<span class="line"><span style="color:#A6ACCD;">Accept-Language: en-GB,en-US;q=0.9,en;q=0.8</span></span>
<span class="line"><span style="color:#A6ACCD;">Priority: u=0, i</span></span></code></pre></div><p>We see that in the header (3rd line) we have the value &quot;<strong>Admin</strong>&quot; set to &quot;<strong>false</strong>&quot;. From the perspective of someone testing the application for security, a &quot;red light&quot; goes on.</p><p>After changing the &quot;false&quot; parameter to &quot;true&quot;, click &quot;Forward&quot; until we are logged in. In every response where we have the Admin=false parameter, we change it to <strong>true</strong>. This will allow us to access the admin panel. We go to the browser and see that we have access to it:</p><p><img src="https://www.dropbox.com/scl/fi/r9fy2dn54g3tanx4qu8j8/pb-sEWiT2Nsgi.png?rlkey=bprwihp1z4mx241wai75qkmgh&amp;raw=1" alt="user role controlled by request parameter admin panel access"></p><p>We go to the admin panel: <img src="https://www.dropbox.com/scl/fi/qqmrkge4lus7ftu0di05t/pb-LXhlL8iwfZ.png?rlkey=j7qvc1cblmvttge0j34wjw78c&amp;raw=1" alt="carlos admin panel"></p><p>We delete the user carlos:</p><p><img src="https://www.dropbox.com/scl/fi/8wkjok0zd5865w5zpr522/pb-sF8Om3hHmH.png?rlkey=dakv6pgoepx3c220ls8efc1zu&amp;raw=1" alt="user role controlled by request parameter carlos deleted"></p>`,26),p=[o];function l(r,c,i,u,h,m){return a(),s("div",null,p)}const y=e(n,[["render",l]]);export{g as __pageData,y as default};
